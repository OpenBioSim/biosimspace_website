<!doctype html>
<html class="no-js" lang="en" data-content_root="../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../genindex.html" /><link rel="search" title="Search" href="../search.html" /><link rel="next" title="Alchemical Transfer Method" href="alchemical_transfer.html" /><link rel="prev" title="Metadynamics" href="metadynamics.html" />

    <link rel="shortcut icon" href="../_static/favicon.ico"/><!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>Alchemical Protein Mutations - openbiosim - biosimspace</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_fonts.css?v=50da5bc0" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_style.css?v=094c566b" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom_pygments.css?v=c839eb9e" />
    
    


<style>
  body {
    --color-code-background: #eeffcc;
  --color-code-foreground: black;
  --font-stack: Changa, sans-serif;
  --font-stack--monospace: Roboto Mono, monospace;
  --color-foreground-primary: #dddddd;
  --color-foreground-secondary: #cccccc;
  --color-foreground-muted: #d0d0d0;
  --color-foreground-border: #923eb1;
  --color-background-primary: #160f30;
  --color-background-secondary: #201146;
  --color-background-hover: #4f4fb0;
  --color-background-hover--transparent: #4f4fb000;
  --color-background-border: #403333;
  --color-background-item: #411a30;
  --color-announcement-background: #000000dd;
  --color-announcement-text: #eeebee;
  --color-admonition-title-background--note: #FFFFFF33;
  --color-admonition-title-background--warning: #FF000033;
  --color-admonition-background: #FFFFFF11;
  --color-brand-primary: #eeeeee;
  --color-brand-content: #00dfef;
  --color-highlight-on-target: #333300;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../index.html"><div class="brand">openbiosim - biosimspace</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../index.html">
  
  <div class="sidebar-logo-container">
    <img class="sidebar-logo" src="../_static/logo.svg" alt="Logo"/>
  </div>
  
  
</a><form class="sidebar-search-container" method="get" action="../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div>
<div class="sidebar-search">
  <div class="version_container">
    <div class="version_label">Branch</div>
    <div id="version_box" class="version_box"></div>
  </div>
</div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../compatibility.html">Compatibility</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quickstart/index.html">Quick Start Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="index.html">Tutorials</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of Tutorials</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="crystal_water.html">Crystal water</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of Crystal water</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="hydration_freenrg.html">Hydration free energy</a></li>
<li class="toctree-l2"><a class="reference internal" href="metadynamics.html">Metadynamics</a></li>
<li class="toctree-l2 current current-page"><a class="current reference internal" href="#">Alchemical Protein Mutations</a></li>
<li class="toctree-l2"><a class="reference internal" href="alchemical_transfer.html">Alchemical Transfer Method</a></li>
<li class="toctree-l2"><a class="reference internal" href="molecular_editing.html">Molecular editing</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../guides/index.html">Detailed Guides</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of Detailed Guides</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/nodes.html">Nodes</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" role="switch" type="checkbox"/><label for="toctree-checkbox-4"><div class="visually-hidden">Toggle navigation of Nodes</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../guides/protocols.html">Protocols</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" role="switch" type="checkbox"/><label for="toctree-checkbox-5"><div class="visually-hidden">Toggle navigation of Protocols</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../api/index.html">API Documentation</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" role="switch" type="checkbox"/><label for="toctree-checkbox-6"><div class="visually-hidden">Toggle navigation of API Documentation</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Align.html">BioSimSpace.Align</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" role="switch" type="checkbox"/><label for="toctree-checkbox-7"><div class="visually-hidden">Toggle navigation of BioSimSpace.Align</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.generateNetwork.html">BioSimSpace.Align.generateNetwork</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.matchAtoms.html">BioSimSpace.Align.matchAtoms</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.rmsdAlign.html">BioSimSpace.Align.rmsdAlign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.flexAlign.html">BioSimSpace.Align.flexAlign</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.merge.html">BioSimSpace.Align.merge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Align.viewMapping.html">BioSimSpace.Align.viewMapping</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Box.html">BioSimSpace.Box</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" role="switch" type="checkbox"/><label for="toctree-checkbox-8"><div class="visually-hidden">Toggle navigation of BioSimSpace.Box</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.boxTypes.html">BioSimSpace.Box.boxTypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.generateBoxParameters.html">BioSimSpace.Box.generateBoxParameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.cubic.html">BioSimSpace.Box.cubic</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.rhombicDodecahedronSquare.html">BioSimSpace.Box.rhombicDodecahedronSquare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.rhombicDodecahedronHexagon.html">BioSimSpace.Box.rhombicDodecahedronHexagon</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Box.truncatedOctahedron.html">BioSimSpace.Box.truncatedOctahedron</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Convert.html">BioSimSpace.Convert</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" role="switch" type="checkbox"/><label for="toctree-checkbox-9"><div class="visually-hidden">Toggle navigation of BioSimSpace.Convert</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.smiles.html">BioSimSpace.Convert.smiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.supportedFormats.html">BioSimSpace.Convert.supportedFormats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.to.html">BioSimSpace.Convert.to</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.toBioSimSpace.html">BioSimSpace.Convert.toBioSimSpace</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.toOpenMM.html">BioSimSpace.Convert.toOpenMM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.toRDKit.html">BioSimSpace.Convert.toRDKit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Convert.toSire.html">BioSimSpace.Convert.toSire</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_FreeEnergy.html">BioSimSpace.FreeEnergy</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" role="switch" type="checkbox"/><label for="toctree-checkbox-10"><div class="visually-hidden">Toggle navigation of BioSimSpace.FreeEnergy</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.FreeEnergy.Relative.html">BioSimSpace.FreeEnergy.Relative</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.FreeEnergy.ATMSetup.html">BioSimSpace.FreeEnergy.ATMSetup</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.FreeEnergy.ATM.html">BioSimSpace.FreeEnergy.ATM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.FreeEnergy.engines.html">BioSimSpace.FreeEnergy.engines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.FreeEnergy.getData.html">BioSimSpace.FreeEnergy.getData</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Gateway.html">BioSimSpace.Gateway</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" role="switch" type="checkbox"/><label for="toctree-checkbox-11"><div class="visually-hidden">Toggle navigation of BioSimSpace.Gateway</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Node.html">BioSimSpace.Gateway.Node</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Boolean.html">BioSimSpace.Gateway.Boolean</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Integer.html">BioSimSpace.Gateway.Integer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Float.html">BioSimSpace.Gateway.Float</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.String.html">BioSimSpace.Gateway.String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.File.html">BioSimSpace.Gateway.File</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.FileSet.html">BioSimSpace.Gateway.FileSet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Length.html">BioSimSpace.Gateway.Length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Area.html">BioSimSpace.Gateway.Area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Volume.html">BioSimSpace.Gateway.Volume</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Charge.html">BioSimSpace.Gateway.Charge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Energy.html">BioSimSpace.Gateway.Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Mass.html">BioSimSpace.Gateway.Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Pressure.html">BioSimSpace.Gateway.Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Temperature.html">BioSimSpace.Gateway.Temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Gateway.Time.html">BioSimSpace.Gateway.Time</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_IO.html">BioSimSpace.IO</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" role="switch" type="checkbox"/><label for="toctree-checkbox-12"><div class="visually-hidden">Toggle navigation of BioSimSpace.IO</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.clearCache.html">BioSimSpace.IO.clearCache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.disableCache.html">BioSimSpace.IO.disableCache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.enableCache.html">BioSimSpace.IO.enableCache</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.fileFormats.html">BioSimSpace.IO.fileFormats</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.formatInfo.html">BioSimSpace.IO.formatInfo</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.readMolecules.html">BioSimSpace.IO.readMolecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.readPDB.html">BioSimSpace.IO.readPDB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.readPerturbableSystem.html">BioSimSpace.IO.readPerturbableSystem</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.saveMolecules.html">BioSimSpace.IO.saveMolecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.IO.savePerturbableSystem.html">BioSimSpace.IO.savePerturbableSystem</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Metadynamics.html">BioSimSpace.Metadynamics</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" role="switch" type="checkbox"/><label for="toctree-checkbox-13"><div class="visually-hidden">Toggle navigation of BioSimSpace.Metadynamics</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.engines.html">BioSimSpace.Metadynamics.engines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.run.html">BioSimSpace.Metadynamics.run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.Bound.html">BioSimSpace.Metadynamics.Bound</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.Grid.html">BioSimSpace.Metadynamics.Grid</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.Restraint.html">BioSimSpace.Metadynamics.Restraint</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../api/index_Metadynamics_CollectiveVariable.html">BioSimSpace.Metadynamics.CollectiveVariable</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" role="switch" type="checkbox"/><label for="toctree-checkbox-14"><div class="visually-hidden">Toggle navigation of BioSimSpace.Metadynamics.CollectiveVariable</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.list.html">BioSimSpace.Metadynamics.CollectiveVariable.list</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.makeFunnel.html">BioSimSpace.Metadynamics.CollectiveVariable.makeFunnel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.viewFunnel.html">BioSimSpace.Metadynamics.CollectiveVariable.viewFunnel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.Distance.html">BioSimSpace.Metadynamics.CollectiveVariable.Distance</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.Funnel.html">BioSimSpace.Metadynamics.CollectiveVariable.Funnel</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.RMSD.html">BioSimSpace.Metadynamics.CollectiveVariable.RMSD</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/generated/BioSimSpace.Metadynamics.CollectiveVariable.Torsion.html">BioSimSpace.Metadynamics.CollectiveVariable.Torsion</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_MD.html">BioSimSpace.MD</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" role="switch" type="checkbox"/><label for="toctree-checkbox-15"><div class="visually-hidden">Toggle navigation of BioSimSpace.MD</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.MD.engines.html">BioSimSpace.MD.engines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.MD.run.html">BioSimSpace.MD.run</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Node.html">BioSimSpace.Node</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" role="switch" type="checkbox"/><label for="toctree-checkbox-16"><div class="visually-hidden">Toggle navigation of BioSimSpace.Node</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Node.help.html">BioSimSpace.Node.help</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Node.list.html">BioSimSpace.Node.list</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Node.run.html">BioSimSpace.Node.run</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Node.setNodeDirectory.html">BioSimSpace.Node.setNodeDirectory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Notebook.html">BioSimSpace.Notebook</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" role="switch" type="checkbox"/><label for="toctree-checkbox-17"><div class="visually-hidden">Toggle navigation of BioSimSpace.Notebook</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Notebook.plot.html">BioSimSpace.Notebook.plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Notebook.plotContour.html">BioSimSpace.Notebook.plotContour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Notebook.plotOverlapMatrix.html">BioSimSpace.Notebook.plotOverlapMatrix</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Notebook.View.html">BioSimSpace.Notebook.View</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Parameters.html">BioSimSpace.Parameters</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" role="switch" type="checkbox"/><label for="toctree-checkbox-18"><div class="visually-hidden">Toggle navigation of BioSimSpace.Parameters</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.amberForceFields.html">BioSimSpace.Parameters.amberForceFields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.amberProteinForceFields.html">BioSimSpace.Parameters.amberProteinForceFields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff03.html">BioSimSpace.Parameters.ff03</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff14SB.html">BioSimSpace.Parameters.ff14SB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff19SB.html">BioSimSpace.Parameters.ff19SB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff99.html">BioSimSpace.Parameters.ff99</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff99SB.html">BioSimSpace.Parameters.ff99SB</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.ff99SBildn.html">BioSimSpace.Parameters.ff99SBildn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.forceFields.html">BioSimSpace.Parameters.forceFields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.gaff.html">BioSimSpace.Parameters.gaff</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.gaff2.html">BioSimSpace.Parameters.gaff2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openForceFields.html">BioSimSpace.Parameters.openForceFields</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_0_0.html">BioSimSpace.Parameters.openff_unconstrained_1_0_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_0_0_RC1.html">BioSimSpace.Parameters.openff_unconstrained_1_0_0_RC1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_0_0_RC2.html">BioSimSpace.Parameters.openff_unconstrained_1_0_0_RC2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_0_1.html">BioSimSpace.Parameters.openff_unconstrained_1_0_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_1_0.html">BioSimSpace.Parameters.openff_unconstrained_1_1_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_1_1.html">BioSimSpace.Parameters.openff_unconstrained_1_1_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_2_0.html">BioSimSpace.Parameters.openff_unconstrained_1_2_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_2_1.html">BioSimSpace.Parameters.openff_unconstrained_1_2_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_3_0.html">BioSimSpace.Parameters.openff_unconstrained_1_3_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_3_1.html">BioSimSpace.Parameters.openff_unconstrained_1_3_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_1_3_1_alpha_1.html">BioSimSpace.Parameters.openff_unconstrained_1_3_1_alpha_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_0_0.html">BioSimSpace.Parameters.openff_unconstrained_2_0_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_0_0_rc_1.html">BioSimSpace.Parameters.openff_unconstrained_2_0_0_rc_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_0_0_rc_2.html">BioSimSpace.Parameters.openff_unconstrained_2_0_0_rc_2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_1_0.html">BioSimSpace.Parameters.openff_unconstrained_2_1_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_1_0_rc_1.html">BioSimSpace.Parameters.openff_unconstrained_2_1_0_rc_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_1_1.html">BioSimSpace.Parameters.openff_unconstrained_2_1_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_2_0.html">BioSimSpace.Parameters.openff_unconstrained_2_2_0</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_2_0_rc1.html">BioSimSpace.Parameters.openff_unconstrained_2_2_0_rc1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_2_1.html">BioSimSpace.Parameters.openff_unconstrained_2_2_1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_2_1_rc1.html">BioSimSpace.Parameters.openff_unconstrained_2_2_1_rc1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.openff_unconstrained_2_3_0_rc1.html">BioSimSpace.Parameters.openff_unconstrained_2_3_0_rc1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.parameterise.html">BioSimSpace.Parameters.parameterise</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Parameters.formalCharge.html">BioSimSpace.Parameters.formalCharge</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Process.html">BioSimSpace.Process</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" role="switch" type="checkbox"/><label for="toctree-checkbox-19"><div class="visually-hidden">Toggle navigation of BioSimSpace.Process</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.engines.html">BioSimSpace.Process.engines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.createProcess.html">BioSimSpace.Process.createProcess</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.Amber.html">BioSimSpace.Process.Amber</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.Gromacs.html">BioSimSpace.Process.Gromacs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.Namd.html">BioSimSpace.Process.Namd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.OpenMM.html">BioSimSpace.Process.OpenMM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.Plumed.html">BioSimSpace.Process.Plumed</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.Somd.html">BioSimSpace.Process.Somd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Process.ProcessRunner.html">BioSimSpace.Process.ProcessRunner</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Protocol.html">BioSimSpace.Protocol</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" role="switch" type="checkbox"/><label for="toctree-checkbox-20"><div class="visually-hidden">Toggle navigation of BioSimSpace.Protocol</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.protocols.html">BioSimSpace.Protocol.protocols</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.createProtocol.html">BioSimSpace.Protocol.createProtocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Minimisation.html">BioSimSpace.Protocol.Minimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Equilibration.html">BioSimSpace.Protocol.Equilibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Production.html">BioSimSpace.Protocol.Production</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.FreeEnergyMinimisation.html">BioSimSpace.Protocol.FreeEnergyMinimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.FreeEnergyEquilibration.html">BioSimSpace.Protocol.FreeEnergyEquilibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.FreeEnergyProduction.html">BioSimSpace.Protocol.FreeEnergyProduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.FreeEnergy.html">BioSimSpace.Protocol.FreeEnergy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Metadynamics.html">BioSimSpace.Protocol.Metadynamics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Steering.html">BioSimSpace.Protocol.Steering</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.Custom.html">BioSimSpace.Protocol.Custom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.ATMMinimisation.html">BioSimSpace.Protocol.ATMMinimisation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.ATMEquilibration.html">BioSimSpace.Protocol.ATMEquilibration</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.ATMAnnealing.html">BioSimSpace.Protocol.ATMAnnealing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Protocol.ATMProduction.html">BioSimSpace.Protocol.ATMProduction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/index_Sandpit.html">BioSimSpace.Sandpit</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Solvent.html">BioSimSpace.Solvent</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" role="switch" type="checkbox"/><label for="toctree-checkbox-21"><div class="visually-hidden">Toggle navigation of BioSimSpace.Solvent</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.solvate.html">BioSimSpace.Solvent.solvate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.spc.html">BioSimSpace.Solvent.spc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.spce.html">BioSimSpace.Solvent.spce</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.tip3p.html">BioSimSpace.Solvent.tip3p</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.tip4p.html">BioSimSpace.Solvent.tip4p</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.tip5p.html">BioSimSpace.Solvent.tip5p</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.opc.html">BioSimSpace.Solvent.opc</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Solvent.waterModels.html">BioSimSpace.Solvent.waterModels</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Stream.html">BioSimSpace.Stream</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" role="switch" type="checkbox"/><label for="toctree-checkbox-22"><div class="visually-hidden">Toggle navigation of BioSimSpace.Stream</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Stream.save.html">BioSimSpace.Stream.save</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Stream.load.html">BioSimSpace.Stream.load</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Trajectory.html">BioSimSpace.Trajectory</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" role="switch" type="checkbox"/><label for="toctree-checkbox-23"><div class="visually-hidden">Toggle navigation of BioSimSpace.Trajectory</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Trajectory.Trajectory.html">BioSimSpace.Trajectory.Trajectory</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Types.html">BioSimSpace.Types</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" role="switch" type="checkbox"/><label for="toctree-checkbox-24"><div class="visually-hidden">Toggle navigation of BioSimSpace.Types</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Angle.html">BioSimSpace.Types.Angle</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Area.html">BioSimSpace.Types.Area</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Charge.html">BioSimSpace.Types.Charge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Coordinate.html">BioSimSpace.Types.Coordinate</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Energy.html">BioSimSpace.Types.Energy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Length.html">BioSimSpace.Types.Length</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Mass.html">BioSimSpace.Types.Mass</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Pressure.html">BioSimSpace.Types.Pressure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Temperature.html">BioSimSpace.Types.Temperature</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Time.html">BioSimSpace.Types.Time</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Vector.html">BioSimSpace.Types.Vector</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Types.Volume.html">BioSimSpace.Types.Volume</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Units.html">BioSimSpace.Units</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" role="switch" type="checkbox"/><label for="toctree-checkbox-25"><div class="visually-hidden">Toggle navigation of BioSimSpace.Units</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Length.meter.html">BioSimSpace.Units.Length.meter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Length.angstrom.html">BioSimSpace.Units.Length.angstrom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Length.nanometer.html">BioSimSpace.Units.Length.nanometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Length.picometer.html">BioSimSpace.Units.Length.picometer</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Area.meter2.html">BioSimSpace.Units.Area.meter2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Area.angstrom2.html">BioSimSpace.Units.Area.angstrom2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Area.nanometer2.html">BioSimSpace.Units.Area.nanometer2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Area.picometer2.html">BioSimSpace.Units.Area.picometer2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Angle.radian.html">BioSimSpace.Units.Angle.radian</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Angle.degree.html">BioSimSpace.Units.Angle.degree</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Volume.meter3.html">BioSimSpace.Units.Volume.meter3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Volume.angstrom3.html">BioSimSpace.Units.Volume.angstrom3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Volume.nanometer3.html">BioSimSpace.Units.Volume.nanometer3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Volume.picometer3.html">BioSimSpace.Units.Volume.picometer3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Charge.electron_charge.html">BioSimSpace.Units.Charge.electron_charge</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Charge.coulomb.html">BioSimSpace.Units.Charge.coulomb</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.kilogram.html">BioSimSpace.Units.Mass.kilogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.gram.html">BioSimSpace.Units.Mass.gram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.milligram.html">BioSimSpace.Units.Mass.milligram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.microgram.html">BioSimSpace.Units.Mass.microgram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.nanogram.html">BioSimSpace.Units.Mass.nanogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.picogram.html">BioSimSpace.Units.Mass.picogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Mass.femtogram.html">BioSimSpace.Units.Mass.femtogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Energy.kcal_per_mol.html">BioSimSpace.Units.Energy.kcal_per_mol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Energy.kj_per_mol.html">BioSimSpace.Units.Energy.kj_per_mol</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Energy.kt.html">BioSimSpace.Units.Energy.kt</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Pressure.atm.html">BioSimSpace.Units.Pressure.atm</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Pressure.bar.html">BioSimSpace.Units.Pressure.bar</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Temperature.kelvin.html">BioSimSpace.Units.Temperature.kelvin</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Temperature.celsius.html">BioSimSpace.Units.Temperature.celsius</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Temperature.fahrenheit.html">BioSimSpace.Units.Temperature.fahrenheit</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.day.html">BioSimSpace.Units.Time.day</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.hour.html">BioSimSpace.Units.Time.hour</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.minute.html">BioSimSpace.Units.Time.minute</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.second.html">BioSimSpace.Units.Time.second</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.millisecond.html">BioSimSpace.Units.Time.millisecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.nanosecond.html">BioSimSpace.Units.Time.nanosecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.picosecond.html">BioSimSpace.Units.Time.picosecond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace.Units.Time.femtosecond.html">BioSimSpace.Units.Time.femtosecond</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Config.html">BioSimSpace._Config</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" role="switch" type="checkbox"/><label for="toctree-checkbox-26"><div class="visually-hidden">Toggle navigation of BioSimSpace._Config</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Config.Amber.html">BioSimSpace._Config.Amber</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Config.Gromacs.html">BioSimSpace._Config.Gromacs</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Config.Somd.html">BioSimSpace._Config.Somd</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Exceptions.html">BioSimSpace._Exceptions</a><input class="toctree-checkbox" id="toctree-checkbox-27" name="toctree-checkbox-27" role="switch" type="checkbox"/><label for="toctree-checkbox-27"><div class="visually-hidden">Toggle navigation of BioSimSpace._Exceptions</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.AlignmentError.html">BioSimSpace._Exceptions.AlignmentError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.AnalysisError.html">BioSimSpace._Exceptions.AnalysisError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.ConversionError.html">BioSimSpace._Exceptions.ConversionError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.IncompatibleError.html">BioSimSpace._Exceptions.IncompatibleError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.MissingSoftwareError.html">BioSimSpace._Exceptions.MissingSoftwareError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.ParameterisationError.html">BioSimSpace._Exceptions.ParameterisationError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.StreamError.html">BioSimSpace._Exceptions.StreamError</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Exceptions.ThirdPartyError.html">BioSimSpace._Exceptions.ThirdPartyError</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_SireWrappers.html">BioSimSpace._SireWrappers</a><input class="toctree-checkbox" id="toctree-checkbox-28" name="toctree-checkbox-28" role="switch" type="checkbox"/><label for="toctree-checkbox-28"><div class="visually-hidden">Toggle navigation of BioSimSpace._SireWrappers</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.Atom.html">BioSimSpace._SireWrappers.Atom</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.Bond.html">BioSimSpace._SireWrappers.Bond</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.Molecule.html">BioSimSpace._SireWrappers.Molecule</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.Molecules.html">BioSimSpace._SireWrappers.Molecules</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.Residue.html">BioSimSpace._SireWrappers.Residue</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.System.html">BioSimSpace._SireWrappers.System</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._SireWrappers.SearchResult.html">BioSimSpace._SireWrappers.SearchResult</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../api/index_Utils.html">BioSimSpace._Utils</a><input class="toctree-checkbox" id="toctree-checkbox-29" name="toctree-checkbox-29" role="switch" type="checkbox"/><label for="toctree-checkbox-29"><div class="visually-hidden">Toggle navigation of BioSimSpace._Utils</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils.WorkDir.html">BioSimSpace._Utils.WorkDir</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils.cd.html">BioSimSpace._Utils.cd</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils.command_split.html">BioSimSpace._Utils.command_split</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils._module_stub.html">BioSimSpace._Utils._module_stub</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils._try_import.html">BioSimSpace._Utils._try_import</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils._have_imported.html">BioSimSpace._Utils._have_imported</a></li>
<li class="toctree-l3"><a class="reference internal" href="../api/generated/BioSimSpace._Utils._assert_imported.html">BioSimSpace._Utils._assert_imported</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../support.html">How to ask for help</a></li>
</ul>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../contributing/index.html">Contributing</a><input class="toctree-checkbox" id="toctree-checkbox-30" name="toctree-checkbox-30" role="switch" type="checkbox"/><label for="toctree-checkbox-30"><div class="visually-hidden">Toggle navigation of Contributing</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../contributing/development.html">Developers guide</a><input class="toctree-checkbox" id="toctree-checkbox-31" name="toctree-checkbox-31" role="switch" type="checkbox"/><label for="toctree-checkbox-31"><div class="visually-hidden">Toggle navigation of Developers guide</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/codestyle.html">Coding Style</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/packaging.html">Development process</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/packaging.html#creating-releases">Creating releases</a></li>
<li class="toctree-l2"><a class="reference internal" href="../contributing/roadmap.html">Roadmap</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../contributors.html">Contributors</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../code_of_conduct.html">Code of Conduct</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          

<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="alchemical-protein-mutations">
<h1>Alchemical Protein Mutations<a class="headerlink" href="#alchemical-protein-mutations" title="Link to this heading"></a></h1>
<section id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Link to this heading"></a></h2>
<p>In this tutorial you will learn how to use BioSimSpaces mapping
functionality to set up alchemical calculations in order to compute the
change in the binding affinity of a ligand as a result of a protein
mutation. Specically, we are going to focus on two proteins, first a set
up of a single alchemical point mutation on ubiquitin, and second a set
up on <a class="reference external" href="https://en.wikipedia.org/wiki/Aldose_reductase">aldose
reductase</a> (AR),
which is a drug target for the treatment of diabetic nephropathy. It is
recommended to complete <a class="reference external" href="https://github.com/OpenBioSim/biosimspace_tutorials">previous BioSimSpace
tutorials</a>
before attempting this one.</p>
<p>The relative change in the binding affinity as a result of a mutation,
<span class="math notranslate nohighlight">\(\Delta \Delta G_{mut}\)</span> can be calculated from the difference
between free energy of mutation in the holo (bound) and apo (unbound)
simulation legs, i.e.:</p>
<a class="reference internal image-reference" href="../_images/pfep_thermodynamic_cycle.png"><img alt="../_images/pfep_thermodynamic_cycle.png" src="../_images/pfep_thermodynamic_cycle.png" style="width: 800px;" />
</a>
<div class="math-wrapper docutils container">
<div class="math notranslate nohighlight">
\[\Delta \Delta G_{mut} = \Delta G_{holo} - \Delta G_{apo}\]</div>
</div>
<p>To get started, lets go through a simple example of generating the
required input files in order to set up an alchemical mutation.</p>
<section id="simple-case-input-file-generation">
<h3>Simple Case - Input File Generation<a class="headerlink" href="#simple-case-input-file-generation" title="Link to this heading"></a></h3>
<p>In order to create an alchemical protein system in BioSimSpace, we need
two input protein structures, a wild-type and a mutant. We also need to
make sure that the atom ordering between the two proteins is identical.
Dont worry, this is an easy assumption to satisfy. We will load a
structure <code class="docutils literal notranslate"><span class="pre">1UBQ</span></code> via <a class="reference external" href="https://sire.openbiosim.org/">sire</a>, which
comes with bundled with BioSimSpace:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">BioSimSpace</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">BSS</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sire</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sr</span>
<span class="n">mols</span> <span class="o">=</span> <span class="n">sr</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;1UBQ&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">INFO</span><span class="p">:</span><span class="n">rdkit</span><span class="p">:</span><span class="n">Enabling</span> <span class="n">RDKit</span> <span class="mf">2024.03.3</span> <span class="n">jupyter</span> <span class="n">extensions</span>
<span class="n">INFO</span><span class="p">:</span><span class="n">numexpr</span><span class="o">.</span><span class="n">utils</span><span class="p">:</span><span class="n">Note</span><span class="p">:</span> <span class="n">NumExpr</span> <span class="n">detected</span> <span class="mi">20</span> <span class="n">cores</span> <span class="n">but</span> <span class="s2">&quot;NUMEXPR_MAX_THREADS&quot;</span> <span class="ow">not</span> <span class="nb">set</span><span class="p">,</span> <span class="n">so</span> <span class="n">enforcing</span> <span class="n">safe</span> <span class="n">limit</span> <span class="n">of</span> <span class="mf">8.</span>
<span class="n">INFO</span><span class="p">:</span><span class="n">numexpr</span><span class="o">.</span><span class="n">utils</span><span class="p">:</span><span class="n">NumExpr</span> <span class="n">defaulting</span> <span class="n">to</span> <span class="mi">8</span> <span class="n">threads</span><span class="o">.</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Using</span> <span class="n">cached</span> <span class="n">download</span> <span class="n">of</span> <span class="s1">&#39;https://files.rcsb.org/download/1UBQ.pdb.gz&#39;</span><span class="o">...</span>
<span class="n">Using</span> <span class="n">cached</span> <span class="n">unzipped</span> <span class="n">file</span> <span class="s1">&#39;./1UBQ.pdb&#39;</span><span class="o">...</span>
</pre></div>
</div>
<p>There are multiple of ways of generating a mutant structure from a
wild-type protein, some examples are: - <a class="reference external" href="https://pymolwiki.org/index.php/Mutagenesis">Pymol Mutagenesis
Plugin</a> (when exporting
the mutant structure, you want to make you select retain atom ids
under PDB Options, or pass both input structures through <em>pdb4amber</em>)
-
<a class="reference external" href="https://software.acellera.com/htmd/tutorials/system-building-protein-protein.html#mutate-modified-residues">HTMD</a>
- <a class="reference external" href="https://foldxsuite.crg.eu/command/BuildModel">FoldX</a> -
<a class="reference external" href="https://ambermd.org/tutorials/basic/tutorial9/index.php">pdb4amber</a></p>
<p>For this simple case we are going to use <em>pdb4amber</em> to mutate a
threonine at position 9 to an alanine residue. First we are going to
pass the wild-type protein from the crystal structure through
<em>pdb4amber</em> in order create a consistent atom ordering between wild-type
and mutant structures:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pdb4amber<span class="w"> </span>--reduce<span class="w"> </span>--dry<span class="w"> </span>--add-missing-atoms<span class="w"> </span>-o<span class="w"> </span>1UBQ_dry_wt.pdb<span class="w"> </span>1UBQ.pdb
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>==================================================
Summary of pdb4amber for: 1UBQ.pdb
===================================================

----------Chains
The following (original) chains have been found:
A

---------- Alternate Locations (Original Residues!))

The following residues had alternate locations:
None
-----------Non-standard-resnames


---------- Missing heavy atom(s)

None
</pre></div>
</div>
<p>Next, we are going to create a mutant structure:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pdb4amber<span class="w"> </span>--reduce<span class="w"> </span>--dry<span class="w"> </span>-o<span class="w"> </span>1UBQ_dry_t9a.pdb<span class="w"> </span>-m<span class="w"> </span><span class="s2">&quot;9-ALA&quot;</span><span class="w"> </span>--add-missing-atoms<span class="w"> </span>1UBQ_dry_wt.pdb
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>==================================================
Summary of pdb4amber for: 1UBQ_dry_wt.pdb
===================================================

----------Chains
The following (original) chains have been found:


---------- Alternate Locations (Original Residues!))

The following residues had alternate locations:
None
-----------Non-standard-resnames


---------- Missing heavy atom(s)

ALA_9 misses 1 heavy atom(s)
</pre></div>
</div>
<div class="alert alert-block alert-warning docutils container">
<p>Warning: This is a simple, but ultimately a crude way of generating a
mutant structure. Different factors such as sidechain rotomers,
packing and protonation states need to be taken into the account in
order to accurately and robustly describe the mutant end-state.</p>
</div>
</section>
<section id="simple-case-alchemical-system-generation">
<h3>Simple Case - Alchemical System Generation<a class="headerlink" href="#simple-case-alchemical-system-generation" title="Link to this heading"></a></h3>
<p>Now that correct input files have been created, we can now proceed to
create an alchemical protein in BioSimSpace. Lets load our two
proteins:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="s2">&quot;1UBQ_dry_wt.pdb&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">protein_mut</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="s2">&quot;1UBQ_dry_t9a.pdb&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>Next, we want to parametrise them with our forcefield of choice:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">ff14SB</span><span class="p">(</span><span class="n">protein_wt</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
<span class="n">protein_mut</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">ff14SB</span><span class="p">(</span><span class="n">protein_mut</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
</pre></div>
</div>
<p>Now we want to compute the mapping between the two proteins, first lets
figure out the residue index of our residue of interest (ROI):</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_wt</span><span class="o">.</span><span class="n">getResidues</span><span class="p">()[</span><span class="mi">7</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LEU&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">19</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;THR&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">14</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GLY&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">7</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_mut</span><span class="o">.</span><span class="n">getResidues</span><span class="p">()[</span><span class="mi">7</span><span class="p">:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;LEU&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">19</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ALA&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">10</span><span class="o">&gt;</span><span class="p">,</span>
 <span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;GLY&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">9</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">7</span><span class="o">&gt;</span><span class="p">]</span>
</pre></div>
</div>
<p>We can see that the residue with the index value of 8 are different
between the two proteins. Lets pass this value to the
<code class="docutils literal notranslate"><span class="pre">`BioSimSpace.Align.matchAtoms</span></code> &lt;<a class="reference external" href="https://biosimspace.openbiosim.org/api/generated/BioSimSpace.Align.matchAtoms.html#BioSimSpace.Align.matchAtoms">https://biosimspace.openbiosim.org/api/generated/BioSimSpace.Align.matchAtoms.html#BioSimSpace.Align.matchAtoms</a>&gt;`__
function:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">matchAtoms</span><span class="p">(</span><span class="n">molecule0</span><span class="o">=</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">molecule1</span><span class="o">=</span><span class="n">protein_mut</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<div class="alert alert-block alert-info docutils container">
<p>Note: You can also pass multiple residues of interest indices to the
mapping if you wish to mutate several residues simultaneously.</p>
</div>
<p>Now that the mapping has been computed, we can visualise it:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">viewMapping</span><span class="p">(</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">protein_mut</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span> <span class="n">pixels</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/ubiquitin_mutation_mapping.png"><img alt="../_images/ubiquitin_mutation_mapping.png" src="../_images/ubiquitin_mutation_mapping.png" style="width: 800px;" />
</a>
<p>The computed atom mapping shows that both hydroxyl and methyl groups in
the threonine side chain will be transformed into hydrogen atoms
respectively. We can now proceed to align the two residues of interest:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aligned_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">rmsdAlign</span><span class="p">(</span><span class="n">molecule0</span><span class="o">=</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">molecule1</span><span class="o">=</span><span class="n">protein_mut</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<p>Finally, we can create a merged alchemical protein system:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_protein</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">aligned_wt</span><span class="p">,</span> <span class="n">protein_mut</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">])</span>
</pre></div>
</div>
<p>The alchemical protein can now be solvated, ionised and exported to
different file formats, for example GROMACS or <a class="reference external" href="https://github.com/OpenBioSim/somd2">SOMD2, our OpenMM-based
FEP engine</a>:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_system</span> <span class="o">=</span> <span class="n">merged_protein</span><span class="o">.</span><span class="n">toSystem</span><span class="p">()</span>

<span class="c1"># solvate the system with the padding of 15 angstroms</span>
<span class="n">padding</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Units</span><span class="o">.</span><span class="n">Length</span><span class="o">.</span><span class="n">angstrom</span>
<span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span> <span class="o">=</span> <span class="n">merged_system</span><span class="o">.</span><span class="n">getAxisAlignedBoundingBox</span><span class="p">()</span>
<span class="n">box_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span><span class="p">)]</span>
<span class="n">box_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">padding</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">box_size</span><span class="p">]</span>

<span class="n">box</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">rhombicDodecahedronHexagon</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">))</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Solvent</span><span class="o">.</span><span class="n">tip3p</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">merged_system</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="n">angles</span><span class="p">,</span> <span class="n">ion_conc</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># export the solvated system to GROMACS input files</span>
<span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveMolecules</span><span class="p">(</span><span class="s2">&quot;apo_ubiquitin_t9a&quot;</span><span class="p">,</span> <span class="n">solvated_system</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;gro87&quot;</span><span class="p">,</span> <span class="s2">&quot;grotop&quot;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># export the solvated system to SOMD2 input file</span>
<span class="n">BSS</span><span class="o">.</span><span class="n">Stream</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">solvated_system</span><span class="p">,</span> <span class="s2">&quot;apo_ubiquitin_t9a&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="aldose-reductase-alchemical-system-generation">
<h2>Aldose Reductase - Alchemical System Generation<a class="headerlink" href="#aldose-reductase-alchemical-system-generation" title="Link to this heading"></a></h2>
<section id="apo-system">
<h3>Apo System<a class="headerlink" href="#apo-system" title="Link to this heading"></a></h3>
<p>Now we are going to focus on the aldose reductase system and set up an
alchemical transformation in both apo and holo forms of the protein. The
input files (2PDG_8.0) were taken from the SI of a <a class="reference external" href="https://pubs.acs.org/doi/full/10.1021/acscentsci.8b00717">paper by Aldeghi et.
al</a>,
residue 47 mutated via PyMol (V47I), and standardised via <em>pdb4amber</em>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">tutorialUrl</span><span class="p">(),</span> <span class="s2">&quot;aldose_reductase_dry.pdb&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">protein_mut</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">tutorialUrl</span><span class="p">(),</span> <span class="s2">&quot;aldose_reductase_v47i_dry.pdb&quot;</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We can use <code class="docutils literal notranslate"><span class="pre">ensure_compatible=False</span></code> in order to get tLEaP to re-add
the hydrogens for us:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">protein_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">ff14SB</span><span class="p">(</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">ensure_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
<span class="n">protein_mut</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">ff14SB</span><span class="p">(</span><span class="n">protein_mut</span><span class="p">,</span> <span class="n">ensure_compatible</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
</pre></div>
</div>
<p>This time we are going to automatically detect the different residues
between the two proteins:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">roi</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">res</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">protein_wt</span><span class="o">.</span><span class="n">getResidues</span><span class="p">()):</span>
    <span class="k">if</span> <span class="n">res</span><span class="o">.</span><span class="n">name</span><span class="p">()</span> <span class="o">!=</span> <span class="n">protein_mut</span><span class="o">.</span><span class="n">getResidues</span><span class="p">()[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">res</span><span class="p">,</span> <span class="n">protein_mut</span><span class="o">.</span><span class="n">getResidues</span><span class="p">()[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">roi</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">index</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;VAL&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">22664</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">16</span><span class="o">&gt;</span> <span class="o">&lt;</span><span class="n">BioSimSpace</span><span class="o">.</span><span class="n">Residue</span><span class="p">:</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ILE&#39;</span><span class="p">,</span> <span class="n">molecule</span><span class="o">=</span><span class="mi">22666</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="mi">45</span><span class="p">,</span> <span class="n">nAtoms</span><span class="o">=</span><span class="mi">19</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>We can then pass these residue indices to the mapping function as
before:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">mapping</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">matchAtoms</span><span class="p">(</span><span class="n">molecule0</span><span class="o">=</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">molecule1</span><span class="o">=</span><span class="n">protein_mut</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">viewMapping</span><span class="p">(</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">protein_mut</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">pixels</span><span class="o">=</span><span class="mi">500</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="../_images/aldose_reductase_mutation_mapping.png"><img alt="../_images/aldose_reductase_mutation_mapping.png" src="../_images/aldose_reductase_mutation_mapping.png" style="width: 800px;" />
</a>
<p>The mapping shows that the perturbation will transform a hydrogen to a
methyl group. Is this what we would expect for a valine to isoleucine
transformation? If we are happy, we can proceed with the rest of the set
up as before:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">aligned_wt</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">rmsdAlign</span><span class="p">(</span><span class="n">molecule0</span><span class="o">=</span><span class="n">protein_wt</span><span class="p">,</span> <span class="n">molecule1</span><span class="o">=</span><span class="n">protein_mut</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">)</span>
<span class="n">merged_protein</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Align</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span><span class="n">aligned_wt</span><span class="p">,</span> <span class="n">protein_mut</span><span class="p">,</span> <span class="n">mapping</span><span class="p">,</span> <span class="n">roi</span><span class="o">=</span><span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_system</span> <span class="o">=</span> <span class="n">merged_protein</span><span class="o">.</span><span class="n">toSystem</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">padding</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Units</span><span class="o">.</span><span class="n">Length</span><span class="o">.</span><span class="n">angstrom</span>

<span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span> <span class="o">=</span> <span class="n">merged_system</span><span class="o">.</span><span class="n">getAxisAlignedBoundingBox</span><span class="p">()</span>
<span class="n">box_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span><span class="p">)]</span>
<span class="n">box_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">padding</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">box_size</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">box</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">rhombicDodecahedronHexagon</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">))</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Solvent</span><span class="o">.</span><span class="n">tip3p</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">merged_system</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="n">angles</span><span class="p">,</span> <span class="n">ion_conc</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveMolecules</span><span class="p">(</span><span class="s2">&quot;apo_aldose_reductase_v47i&quot;</span><span class="p">,</span> <span class="n">solvated_system</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;gro87&quot;</span><span class="p">,</span> <span class="s2">&quot;grotop&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
<section id="holo-system">
<h3>Holo System<a class="headerlink" href="#holo-system" title="Link to this heading"></a></h3>
<p>To set up a holo (bound) system, we are going to load in the associated
ligand and the cofactor of aldose reductase:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand_47d</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">tutorialUrl</span><span class="p">(),</span> <span class="p">[</span><span class="s2">&quot;ligand_47_gaff2.gro&quot;</span><span class="p">,</span> <span class="s2">&quot;ligand_47_gaff2.top&quot;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cofactor_nap</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">readMolecules</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">expand</span><span class="p">(</span><span class="n">BSS</span><span class="o">.</span><span class="n">tutorialUrl</span><span class="p">(),</span> <span class="p">[</span><span class="s2">&quot;cofactor_nap_gaff2.gro&quot;</span><span class="p">,</span> <span class="s2">&quot;cofactor_nap_gaff2.top&quot;</span><span class="p">]))[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<p>We can use BioSimSpaces AMBER parametrisation pipeline if we wish to,
but in this case the ligands have been parametrised for us so we can
skip the following cell:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ligand_47d</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">gaff2</span><span class="p">(</span><span class="n">ligand_47d</span><span class="p">,</span> <span class="n">charge_method</span><span class="o">=</span><span class="s2">&quot;BCC&quot;</span><span class="p">,</span> <span class="n">net_charge</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
<span class="n">cofactor_nap</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Parameters</span><span class="o">.</span><span class="n">gaff2</span><span class="p">(</span><span class="n">cofactor_nap</span><span class="p">,</span> <span class="n">charge_method</span><span class="o">=</span><span class="s2">&quot;BCC&quot;</span><span class="p">,</span> <span class="n">net_charge</span><span class="o">=-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">getMolecule</span><span class="p">()</span>
</pre></div>
</div>
<p>We can simply add the ligands to our alchemical protein in order to
create an alchemical holo system. This way we are assuming that the
ligands are already placed correctly with respect to the protein:</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">merged_system</span> <span class="o">=</span> <span class="n">merged_protein</span> <span class="o">+</span> <span class="n">ligand_47d</span> <span class="o">+</span> <span class="n">cofactor_nap</span>
</pre></div>
</div>
<p>As before we can now proceed to solvate, ionise and export our prepared
system or use BioSimSpaces functionallity to <a class="reference external" href="https://github.com/OpenBioSim/biosimspace_tutorials/tree/main/04_fep">further set up and
execute the alchemical
simulations</a>.</p>
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">padding</span> <span class="o">=</span> <span class="mi">15</span> <span class="o">*</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Units</span><span class="o">.</span><span class="n">Length</span><span class="o">.</span><span class="n">angstrom</span>

<span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span> <span class="o">=</span> <span class="n">merged_system</span><span class="o">.</span><span class="n">getAxisAlignedBoundingBox</span><span class="p">()</span>
<span class="n">box_size</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="o">-</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">box_min</span><span class="p">,</span> <span class="n">box_max</span><span class="p">)]</span>
<span class="n">box_sizes</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">+</span> <span class="n">padding</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">box_size</span><span class="p">]</span>

<span class="n">box</span><span class="p">,</span> <span class="n">angles</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Box</span><span class="o">.</span><span class="n">rhombicDodecahedronHexagon</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">box_sizes</span><span class="p">))</span>
<span class="n">solvated_system</span> <span class="o">=</span> <span class="n">BSS</span><span class="o">.</span><span class="n">Solvent</span><span class="o">.</span><span class="n">tip3p</span><span class="p">(</span><span class="n">molecule</span><span class="o">=</span><span class="n">merged_system</span><span class="p">,</span> <span class="n">box</span><span class="o">=</span><span class="n">box</span><span class="p">,</span> <span class="n">angles</span><span class="o">=</span><span class="n">angles</span><span class="p">,</span> <span class="n">ion_conc</span><span class="o">=</span><span class="mf">0.15</span><span class="p">)</span>

<span class="n">BSS</span><span class="o">.</span><span class="n">IO</span><span class="o">.</span><span class="n">saveMolecules</span><span class="p">(</span><span class="s2">&quot;holo_aldose_reductase_v47i&quot;</span><span class="p">,</span> <span class="n">solvated_system</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;gro87&quot;</span><span class="p">,</span> <span class="s2">&quot;grotop&quot;</span><span class="p">])</span>
</pre></div>
</div>
</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="alchemical_transfer.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title">Alchemical Transfer Method</div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="metadynamics.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Metadynamics</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            Made with 
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            <div class="last-updated">
              Last updated on Nov 10, 2025</div>
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">Alchemical Protein Mutations</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a><ul>
<li><a class="reference internal" href="#simple-case-input-file-generation">Simple Case - Input File Generation</a></li>
<li><a class="reference internal" href="#simple-case-alchemical-system-generation">Simple Case - Alchemical System Generation</a></li>
</ul>
</li>
<li><a class="reference internal" href="#aldose-reductase-alchemical-system-generation">Aldose Reductase - Alchemical System Generation</a><ul>
<li><a class="reference internal" href="#apo-system">Apo System</a></li>
<li><a class="reference internal" href="#holo-system">Holo System</a></li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="../_static/documentation_options.js?v=5929fcd5"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/furo.js?v=5fa4622c"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../_static/js/custom.js?v=e0b44004"></script>
    </body>
</html>